<script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();
  const form = document.getElementById('chatForm');
  const input = document.getElementById('messageInput');
  const messages = document.getElementById('messages');

  // ìƒˆë¡œê³ ì¹¨í•´ë„ ì±„íŒ…ê¸°ë¡ ë‚¨ê¸°ê¸°
  function saveMessages() {
    localStorage.setItem('chatMessages', messages.innerHTML);
  }

  function loadMessages() {
    const saved = localStorage.getItem('chatMessages');
    if (saved) {
      messages.innerHTML = saved;
    }
  }

  loadMessages(); // í˜ì´ì§€ ì—´ë¦¬ë©´ ì €ì¥ëœ ë©”ì‹œì§€ ë¶ˆëŸ¬ì˜¤ê¸°

  form.addEventListener('submit', function(e) {
    e.preventDefault();
    if (input.value) {
      socket.emit('chat message', input.value);
      input.value = '';
    }
  });

  socket.on('chat message', function(msg) {
    const item = document.createElement('li');
    item.textContent = msg;
    messages.appendChild(item);
    saveMessages(); // ì±„íŒ… ë°›ì„ ë•Œë§ˆë‹¤ ì €ì¥

    // ğŸ”¥ ìƒˆ ë©”ì‹œì§€ê°€ ì¶”ê°€ë  ë•Œë§ˆë‹¤ ìë™ ìŠ¤í¬ë¡¤ ë§¨ ì•„ë˜ë¡œ ì´ë™!
    messages.scrollTop = messages.scrollHeight;
  });
</script>
